{"ast":null,"code":"'use strict';\n\nrequire(\"core-js/modules/es.array.push.js\");\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nvar vue = require('vue');\nvar AsyncValidator = require('async-validator');\nvar lodashUnified = require('lodash-unified');\nvar core = require('@vueuse/core');\nrequire('../../../utils/index.js');\nrequire('../../../hooks/index.js');\nrequire('./hooks/index.js');\nvar formItem = require('./form-item.js');\nvar formLabelWrap = require('./form-label-wrap.js');\nvar constants = require('./constants.js');\nvar pluginVue_exportHelper = require('../../../_virtual/plugin-vue_export-helper.js');\nvar useFormCommonProps = require('./hooks/use-form-common-props.js');\nvar index = require('../../../hooks/use-namespace/index.js');\nvar index$1 = require('../../../hooks/use-id/index.js');\nvar style = require('../../../utils/dom/style.js');\nvar types = require('../../../utils/types.js');\nvar shared = require('@vue/shared');\nvar objects = require('../../../utils/objects.js');\nfunction _interopDefaultLegacy(e) {\n  return e && typeof e === 'object' && 'default' in e ? e : {\n    'default': e\n  };\n}\nvar AsyncValidator__default = /*#__PURE__*/_interopDefaultLegacy(AsyncValidator);\nconst _hoisted_1 = [\"role\", \"aria-labelledby\"];\nconst __default__ = vue.defineComponent({\n  name: \"ElFormItem\"\n});\nconst _sfc_main = /* @__PURE__ */vue.defineComponent({\n  ...__default__,\n  props: formItem.formItemProps,\n  setup(__props, {\n    expose\n  }) {\n    const props = __props;\n    const slots = vue.useSlots();\n    const formContext = vue.inject(constants.formContextKey, void 0);\n    const parentFormItemContext = vue.inject(constants.formItemContextKey, void 0);\n    const _size = useFormCommonProps.useFormSize(void 0, {\n      formItem: false\n    });\n    const ns = index.useNamespace(\"form-item\");\n    const labelId = index$1.useId().value;\n    const inputIds = vue.ref([]);\n    const validateState = vue.ref(\"\");\n    const validateStateDebounced = core.refDebounced(validateState, 100);\n    const validateMessage = vue.ref(\"\");\n    const formItemRef = vue.ref();\n    let initialValue = void 0;\n    let isResettingField = false;\n    const labelStyle = vue.computed(() => {\n      if ((formContext == null ? void 0 : formContext.labelPosition) === \"top\") {\n        return {};\n      }\n      const labelWidth = style.addUnit(props.labelWidth || (formContext == null ? void 0 : formContext.labelWidth) || \"\");\n      if (labelWidth) return {\n        width: labelWidth\n      };\n      return {};\n    });\n    const contentStyle = vue.computed(() => {\n      if ((formContext == null ? void 0 : formContext.labelPosition) === \"top\" || (formContext == null ? void 0 : formContext.inline)) {\n        return {};\n      }\n      if (!props.label && !props.labelWidth && isNested) {\n        return {};\n      }\n      const labelWidth = style.addUnit(props.labelWidth || (formContext == null ? void 0 : formContext.labelWidth) || \"\");\n      if (!props.label && !slots.label) {\n        return {\n          marginLeft: labelWidth\n        };\n      }\n      return {};\n    });\n    const formItemClasses = vue.computed(() => [ns.b(), ns.m(_size.value), ns.is(\"error\", validateState.value === \"error\"), ns.is(\"validating\", validateState.value === \"validating\"), ns.is(\"success\", validateState.value === \"success\"), ns.is(\"required\", isRequired.value || props.required), ns.is(\"no-asterisk\", formContext == null ? void 0 : formContext.hideRequiredAsterisk), (formContext == null ? void 0 : formContext.requireAsteriskPosition) === \"right\" ? \"asterisk-right\" : \"asterisk-left\", {\n      [ns.m(\"feedback\")]: formContext == null ? void 0 : formContext.statusIcon\n    }]);\n    const _inlineMessage = vue.computed(() => types.isBoolean(props.inlineMessage) ? props.inlineMessage : (formContext == null ? void 0 : formContext.inlineMessage) || false);\n    const validateClasses = vue.computed(() => [ns.e(\"error\"), {\n      [ns.em(\"error\", \"inline\")]: _inlineMessage.value\n    }]);\n    const propString = vue.computed(() => {\n      if (!props.prop) return \"\";\n      return shared.isString(props.prop) ? props.prop : props.prop.join(\".\");\n    });\n    const hasLabel = vue.computed(() => {\n      return !!(props.label || slots.label);\n    });\n    const labelFor = vue.computed(() => {\n      return props.for || (inputIds.value.length === 1 ? inputIds.value[0] : void 0);\n    });\n    const isGroup = vue.computed(() => {\n      return !labelFor.value && hasLabel.value;\n    });\n    const isNested = !!parentFormItemContext;\n    const fieldValue = vue.computed(() => {\n      const model = formContext == null ? void 0 : formContext.model;\n      if (!model || !props.prop) {\n        return;\n      }\n      return objects.getProp(model, props.prop).value;\n    });\n    const normalizedRules = vue.computed(() => {\n      const {\n        required\n      } = props;\n      const rules = [];\n      if (props.rules) {\n        rules.push(...lodashUnified.castArray(props.rules));\n      }\n      const formRules = formContext == null ? void 0 : formContext.rules;\n      if (formRules && props.prop) {\n        const _rules = objects.getProp(formRules, props.prop).value;\n        if (_rules) {\n          rules.push(...lodashUnified.castArray(_rules));\n        }\n      }\n      if (required !== void 0) {\n        const requiredRules = rules.map((rule, i) => [rule, i]).filter(([rule]) => Object.keys(rule).includes(\"required\"));\n        if (requiredRules.length > 0) {\n          for (const [rule, i] of requiredRules) {\n            if (rule.required === required) continue;\n            rules[i] = {\n              ...rule,\n              required\n            };\n          }\n        } else {\n          rules.push({\n            required\n          });\n        }\n      }\n      return rules;\n    });\n    const validateEnabled = vue.computed(() => normalizedRules.value.length > 0);\n    const getFilteredRule = trigger => {\n      const rules = normalizedRules.value;\n      return rules.filter(rule => {\n        if (!rule.trigger || !trigger) return true;\n        if (Array.isArray(rule.trigger)) {\n          return rule.trigger.includes(trigger);\n        } else {\n          return rule.trigger === trigger;\n        }\n      }).map(({\n        trigger: trigger2,\n        ...rule\n      }) => rule);\n    };\n    const isRequired = vue.computed(() => normalizedRules.value.some(rule => rule.required));\n    const shouldShowError = vue.computed(() => {\n      var _a;\n      return validateStateDebounced.value === \"error\" && props.showMessage && ((_a = formContext == null ? void 0 : formContext.showMessage) != null ? _a : true);\n    });\n    const currentLabel = vue.computed(() => `${props.label || \"\"}${(formContext == null ? void 0 : formContext.labelSuffix) || \"\"}`);\n    const setValidationState = state => {\n      validateState.value = state;\n    };\n    const onValidationFailed = error => {\n      var _a, _b;\n      const {\n        errors,\n        fields\n      } = error;\n      if (!errors || !fields) {\n        console.error(error);\n      }\n      setValidationState(\"error\");\n      validateMessage.value = errors ? (_b = (_a = errors == null ? void 0 : errors[0]) == null ? void 0 : _a.message) != null ? _b : `${props.prop} is required` : \"\";\n      formContext == null ? void 0 : formContext.emit(\"validate\", props.prop, false, validateMessage.value);\n    };\n    const onValidationSucceeded = () => {\n      setValidationState(\"success\");\n      formContext == null ? void 0 : formContext.emit(\"validate\", props.prop, true, \"\");\n    };\n    const doValidate = async rules => {\n      const modelName = propString.value;\n      const validator = new AsyncValidator__default[\"default\"]({\n        [modelName]: rules\n      });\n      return validator.validate({\n        [modelName]: fieldValue.value\n      }, {\n        firstFields: true\n      }).then(() => {\n        onValidationSucceeded();\n        return true;\n      }).catch(err => {\n        onValidationFailed(err);\n        return Promise.reject(err);\n      });\n    };\n    const validate = async (trigger, callback) => {\n      if (isResettingField || !props.prop) {\n        return false;\n      }\n      const hasCallback = shared.isFunction(callback);\n      if (!validateEnabled.value) {\n        callback == null ? void 0 : callback(false);\n        return false;\n      }\n      const rules = getFilteredRule(trigger);\n      if (rules.length === 0) {\n        callback == null ? void 0 : callback(true);\n        return true;\n      }\n      setValidationState(\"validating\");\n      return doValidate(rules).then(() => {\n        callback == null ? void 0 : callback(true);\n        return true;\n      }).catch(err => {\n        const {\n          fields\n        } = err;\n        callback == null ? void 0 : callback(false, fields);\n        return hasCallback ? false : Promise.reject(fields);\n      });\n    };\n    const clearValidate = () => {\n      setValidationState(\"\");\n      validateMessage.value = \"\";\n      isResettingField = false;\n    };\n    const resetField = async () => {\n      const model = formContext == null ? void 0 : formContext.model;\n      if (!model || !props.prop) return;\n      const computedValue = objects.getProp(model, props.prop);\n      isResettingField = true;\n      computedValue.value = lodashUnified.clone(initialValue);\n      await vue.nextTick();\n      clearValidate();\n      isResettingField = false;\n    };\n    const addInputId = id => {\n      if (!inputIds.value.includes(id)) {\n        inputIds.value.push(id);\n      }\n    };\n    const removeInputId = id => {\n      inputIds.value = inputIds.value.filter(listId => listId !== id);\n    };\n    vue.watch(() => props.error, val => {\n      validateMessage.value = val || \"\";\n      setValidationState(val ? \"error\" : \"\");\n    }, {\n      immediate: true\n    });\n    vue.watch(() => props.validateStatus, val => setValidationState(val || \"\"));\n    const context = vue.reactive({\n      ...vue.toRefs(props),\n      $el: formItemRef,\n      size: _size,\n      validateState,\n      labelId,\n      inputIds,\n      isGroup,\n      hasLabel,\n      addInputId,\n      removeInputId,\n      resetField,\n      clearValidate,\n      validate\n    });\n    vue.provide(constants.formItemContextKey, context);\n    vue.onMounted(() => {\n      if (props.prop) {\n        formContext == null ? void 0 : formContext.addField(context);\n        initialValue = lodashUnified.clone(fieldValue.value);\n      }\n    });\n    vue.onBeforeUnmount(() => {\n      formContext == null ? void 0 : formContext.removeField(context);\n    });\n    expose({\n      size: _size,\n      validateMessage,\n      validateState,\n      validate,\n      clearValidate,\n      resetField\n    });\n    return (_ctx, _cache) => {\n      var _a;\n      return vue.openBlock(), vue.createElementBlock(\"div\", {\n        ref_key: \"formItemRef\",\n        ref: formItemRef,\n        class: vue.normalizeClass(vue.unref(formItemClasses)),\n        role: vue.unref(isGroup) ? \"group\" : void 0,\n        \"aria-labelledby\": vue.unref(isGroup) ? vue.unref(labelId) : void 0\n      }, [vue.createVNode(vue.unref(formLabelWrap[\"default\"]), {\n        \"is-auto-width\": vue.unref(labelStyle).width === \"auto\",\n        \"update-all\": ((_a = vue.unref(formContext)) == null ? void 0 : _a.labelWidth) === \"auto\"\n      }, {\n        default: vue.withCtx(() => [vue.unref(hasLabel) ? (vue.openBlock(), vue.createBlock(vue.resolveDynamicComponent(vue.unref(labelFor) ? \"label\" : \"div\"), {\n          key: 0,\n          id: vue.unref(labelId),\n          for: vue.unref(labelFor),\n          class: vue.normalizeClass(vue.unref(ns).e(\"label\")),\n          style: vue.normalizeStyle(vue.unref(labelStyle))\n        }, {\n          default: vue.withCtx(() => [vue.renderSlot(_ctx.$slots, \"label\", {\n            label: vue.unref(currentLabel)\n          }, () => [vue.createTextVNode(vue.toDisplayString(vue.unref(currentLabel)), 1)])]),\n          _: 3\n        }, 8, [\"id\", \"for\", \"class\", \"style\"])) : vue.createCommentVNode(\"v-if\", true)]),\n        _: 3\n      }, 8, [\"is-auto-width\", \"update-all\"]), vue.createElementVNode(\"div\", {\n        class: vue.normalizeClass(vue.unref(ns).e(\"content\")),\n        style: vue.normalizeStyle(vue.unref(contentStyle))\n      }, [vue.renderSlot(_ctx.$slots, \"default\"), vue.createVNode(vue.TransitionGroup, {\n        name: `${vue.unref(ns).namespace.value}-zoom-in-top`\n      }, {\n        default: vue.withCtx(() => [vue.unref(shouldShowError) ? vue.renderSlot(_ctx.$slots, \"error\", {\n          key: 0,\n          error: validateMessage.value\n        }, () => [vue.createElementVNode(\"div\", {\n          class: vue.normalizeClass(vue.unref(validateClasses))\n        }, vue.toDisplayString(validateMessage.value), 3)]) : vue.createCommentVNode(\"v-if\", true)]),\n        _: 3\n      }, 8, [\"name\"])], 6)], 10, _hoisted_1);\n    };\n  }\n});\nvar FormItem = /* @__PURE__ */pluginVue_exportHelper[\"default\"](_sfc_main, [[\"__file\", \"/home/runner/work/element-plus/element-plus/packages/components/form/src/form-item.vue\"]]);\nexports[\"default\"] = FormItem;","map":{"version":3,"names":["name","slots","vue","useSlots","formContext","inject","constants","formContextKey","parentFormItemContext","formItemContextKey","_size","useFormCommonProps","useFormSize","formItem","ns","index","useNamespace","labelId","index$1","useId","value","inputIds","ref","validateState","validateStateDebounced","core","refDebounced","validateMessage","formItemRef","initialValue","isResettingField","labelStyle","computed","labelPosition","labelWidth","style","addUnit","props","width","contentStyle","inline","label","isNested","marginLeft","formItemClasses","b","m","is","isRequired","required","hideRequiredAsterisk","requireAsteriskPosition","statusIcon","_inlineMessage","types","isBoolean","inlineMessage","validateClasses","e","em","propString","prop","shared","isString","join","hasLabel","labelFor","for","length","isGroup","fieldValue","model","objects","getProp","normalizedRules","rules","push","lodashUnified","castArray","formRules","_rules","requiredRules","map","rule","i","filter","Object","keys","includes","validateEnabled","getFilteredRule","trigger","Array","isArray","trigger2","some","shouldShowError","_a","showMessage","currentLabel","labelSuffix","setValidationState","state","onValidationFailed","error","_b","errors","fields","console","message","emit","onValidationSucceeded","doValidate","modelName","validator","AsyncValidator__default","validate","firstFields","then","catch","err","Promise","reject","callback","hasCallback","isFunction","clearValidate","resetField","computedValue","clone","nextTick","addInputId","id","removeInputId","listId","watch","val","immediate","validateStatus","context","reactive","toRefs","$el","size","provide","onMounted","addField","onBeforeUnmount","removeField","expose"],"sources":["../../../../../../packages/components/form/src/form-item.vue"],"sourcesContent":["<template>\n  <div\n    ref=\"formItemRef\"\n    :class=\"formItemClasses\"\n    :role=\"isGroup ? 'group' : undefined\"\n    :aria-labelledby=\"isGroup ? labelId : undefined\"\n  >\n    <form-label-wrap\n      :is-auto-width=\"labelStyle.width === 'auto'\"\n      :update-all=\"formContext?.labelWidth === 'auto'\"\n    >\n      <component\n        :is=\"labelFor ? 'label' : 'div'\"\n        v-if=\"hasLabel\"\n        :id=\"labelId\"\n        :for=\"labelFor\"\n        :class=\"ns.e('label')\"\n        :style=\"labelStyle\"\n      >\n        <slot name=\"label\" :label=\"currentLabel\">\n          {{ currentLabel }}\n        </slot>\n      </component>\n    </form-label-wrap>\n\n    <div :class=\"ns.e('content')\" :style=\"contentStyle\">\n      <slot />\n      <transition-group :name=\"`${ns.namespace.value}-zoom-in-top`\">\n        <slot v-if=\"shouldShowError\" name=\"error\" :error=\"validateMessage\">\n          <div :class=\"validateClasses\">\n            {{ validateMessage }}\n          </div>\n        </slot>\n      </transition-group>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\nimport {\n  computed,\n  inject,\n  nextTick,\n  onBeforeUnmount,\n  onMounted,\n  provide,\n  reactive,\n  ref,\n  toRefs,\n  useSlots,\n  watch,\n} from 'vue'\nimport AsyncValidator from 'async-validator'\nimport { clone } from 'lodash-unified'\nimport { refDebounced } from '@vueuse/core'\nimport {\n  addUnit,\n  ensureArray,\n  getProp,\n  isBoolean,\n  isFunction,\n  isString,\n} from '@element-plus/utils'\nimport { useId, useNamespace } from '@element-plus/hooks'\nimport { useFormSize } from './hooks'\nimport { formItemProps } from './form-item'\nimport FormLabelWrap from './form-label-wrap'\nimport { formContextKey, formItemContextKey } from './constants'\n\nimport type { CSSProperties } from 'vue'\nimport type { RuleItem } from 'async-validator'\nimport type { Arrayable } from '@element-plus/utils'\nimport type {\n  FormItemContext,\n  FormItemRule,\n  FormValidateFailure,\n} from './types'\nimport type { FormItemValidateState } from './form-item'\n\ndefineOptions({\n  name: 'ElFormItem',\n})\nconst props = defineProps(formItemProps)\nconst slots = useSlots()\n\nconst formContext = inject(formContextKey, undefined)\nconst parentFormItemContext = inject(formItemContextKey, undefined)\n\nconst _size = useFormSize(undefined, { formItem: false })\nconst ns = useNamespace('form-item')\n\nconst labelId = useId().value\nconst inputIds = ref<string[]>([])\n\nconst validateState = ref<FormItemValidateState>('')\nconst validateStateDebounced = refDebounced(validateState, 100)\nconst validateMessage = ref('')\nconst formItemRef = ref<HTMLDivElement>()\n// special inline value.\nlet initialValue: any = undefined\nlet isResettingField = false\n\nconst labelStyle = computed<CSSProperties>(() => {\n  if (formContext?.labelPosition === 'top') {\n    return {}\n  }\n\n  const labelWidth = addUnit(props.labelWidth || formContext?.labelWidth || '')\n  if (labelWidth) return { width: labelWidth }\n  return {}\n})\n\nconst contentStyle = computed<CSSProperties>(() => {\n  if (formContext?.labelPosition === 'top' || formContext?.inline) {\n    return {}\n  }\n  if (!props.label && !props.labelWidth && isNested) {\n    return {}\n  }\n  const labelWidth = addUnit(props.labelWidth || formContext?.labelWidth || '')\n  if (!props.label && !slots.label) {\n    return { marginLeft: labelWidth }\n  }\n  return {}\n})\n\nconst formItemClasses = computed(() => [\n  ns.b(),\n  ns.m(_size.value),\n  ns.is('error', validateState.value === 'error'),\n  ns.is('validating', validateState.value === 'validating'),\n  ns.is('success', validateState.value === 'success'),\n  ns.is('required', isRequired.value || props.required),\n  ns.is('no-asterisk', formContext?.hideRequiredAsterisk),\n  formContext?.requireAsteriskPosition === 'right'\n    ? 'asterisk-right'\n    : 'asterisk-left',\n  { [ns.m('feedback')]: formContext?.statusIcon },\n])\n\nconst _inlineMessage = computed(() =>\n  isBoolean(props.inlineMessage)\n    ? props.inlineMessage\n    : formContext?.inlineMessage || false\n)\n\nconst validateClasses = computed(() => [\n  ns.e('error'),\n  { [ns.em('error', 'inline')]: _inlineMessage.value },\n])\n\nconst propString = computed(() => {\n  if (!props.prop) return ''\n  return isString(props.prop) ? props.prop : props.prop.join('.')\n})\n\nconst hasLabel = computed<boolean>(() => {\n  return !!(props.label || slots.label)\n})\n\nconst labelFor = computed<string | undefined>(() => {\n  return (\n    props.for || (inputIds.value.length === 1 ? inputIds.value[0] : undefined)\n  )\n})\n\nconst isGroup = computed<boolean>(() => {\n  return !labelFor.value && hasLabel.value\n})\n\nconst isNested = !!parentFormItemContext\n\nconst fieldValue = computed(() => {\n  const model = formContext?.model\n  if (!model || !props.prop) {\n    return\n  }\n  return getProp(model, props.prop).value\n})\n\nconst normalizedRules = computed(() => {\n  const { required } = props\n\n  const rules: FormItemRule[] = []\n\n  if (props.rules) {\n    rules.push(...ensureArray(props.rules))\n  }\n\n  const formRules = formContext?.rules\n  if (formRules && props.prop) {\n    const _rules = getProp<Arrayable<FormItemRule> | undefined>(\n      formRules,\n      props.prop\n    ).value\n    if (_rules) {\n      rules.push(...ensureArray(_rules))\n    }\n  }\n\n  if (required !== undefined) {\n    const requiredRules = rules\n      .map((rule, i) => [rule, i] as const)\n      .filter(([rule]) => Object.keys(rule).includes('required'))\n\n    if (requiredRules.length > 0) {\n      for (const [rule, i] of requiredRules) {\n        if (rule.required === required) continue\n        rules[i] = { ...rule, required }\n      }\n    } else {\n      rules.push({ required })\n    }\n  }\n\n  return rules\n})\n\nconst validateEnabled = computed(() => normalizedRules.value.length > 0)\n\nconst getFilteredRule = (trigger: string) => {\n  const rules = normalizedRules.value\n  return (\n    rules\n      .filter((rule) => {\n        if (!rule.trigger || !trigger) return true\n        if (Array.isArray(rule.trigger)) {\n          return rule.trigger.includes(trigger)\n        } else {\n          return rule.trigger === trigger\n        }\n      })\n      // exclude trigger\n      // eslint-disable-next-line @typescript-eslint/no-unused-vars\n      .map(({ trigger, ...rule }): RuleItem => rule)\n  )\n}\n\nconst isRequired = computed(() =>\n  normalizedRules.value.some((rule) => rule.required)\n)\n\nconst shouldShowError = computed(\n  () =>\n    validateStateDebounced.value === 'error' &&\n    props.showMessage &&\n    (formContext?.showMessage ?? true)\n)\n\nconst currentLabel = computed(\n  () => `${props.label || ''}${formContext?.labelSuffix || ''}`\n)\n\nconst setValidationState = (state: FormItemValidateState) => {\n  validateState.value = state\n}\n\nconst onValidationFailed = (error: FormValidateFailure) => {\n  const { errors, fields } = error\n  if (!errors || !fields) {\n    console.error(error)\n  }\n\n  setValidationState('error')\n  validateMessage.value = errors\n    ? errors?.[0]?.message ?? `${props.prop} is required`\n    : ''\n\n  formContext?.emit('validate', props.prop!, false, validateMessage.value)\n}\n\nconst onValidationSucceeded = () => {\n  setValidationState('success')\n  formContext?.emit('validate', props.prop!, true, '')\n}\n\nconst doValidate = async (rules: RuleItem[]): Promise<true> => {\n  const modelName = propString.value\n  const validator = new AsyncValidator({\n    [modelName]: rules,\n  })\n  return validator\n    .validate({ [modelName]: fieldValue.value }, { firstFields: true })\n    .then(() => {\n      onValidationSucceeded()\n      return true as const\n    })\n    .catch((err: FormValidateFailure) => {\n      onValidationFailed(err as FormValidateFailure)\n      return Promise.reject(err)\n    })\n}\n\nconst validate: FormItemContext['validate'] = async (trigger, callback) => {\n  // skip validation if its resetting\n  if (isResettingField || !props.prop) {\n    return false\n  }\n\n  const hasCallback = isFunction(callback)\n  if (!validateEnabled.value) {\n    callback?.(false)\n    return false\n  }\n\n  const rules = getFilteredRule(trigger)\n  if (rules.length === 0) {\n    callback?.(true)\n    return true\n  }\n\n  setValidationState('validating')\n\n  return doValidate(rules)\n    .then(() => {\n      callback?.(true)\n      return true as const\n    })\n    .catch((err: FormValidateFailure) => {\n      const { fields } = err\n      callback?.(false, fields)\n      return hasCallback ? false : Promise.reject(fields)\n    })\n}\n\nconst clearValidate: FormItemContext['clearValidate'] = () => {\n  setValidationState('')\n  validateMessage.value = ''\n  isResettingField = false\n}\n\nconst resetField: FormItemContext['resetField'] = async () => {\n  const model = formContext?.model\n  if (!model || !props.prop) return\n\n  const computedValue = getProp(model, props.prop)\n\n  // prevent validation from being triggered\n  isResettingField = true\n\n  computedValue.value = clone(initialValue)\n\n  await nextTick()\n  clearValidate()\n\n  isResettingField = false\n}\n\nconst addInputId: FormItemContext['addInputId'] = (id: string) => {\n  if (!inputIds.value.includes(id)) {\n    inputIds.value.push(id)\n  }\n}\n\nconst removeInputId: FormItemContext['removeInputId'] = (id: string) => {\n  inputIds.value = inputIds.value.filter((listId) => listId !== id)\n}\n\nwatch(\n  () => props.error,\n  (val) => {\n    validateMessage.value = val || ''\n    setValidationState(val ? 'error' : '')\n  },\n  { immediate: true }\n)\n\nwatch(\n  () => props.validateStatus,\n  (val) => setValidationState(val || '')\n)\n\nconst context: FormItemContext = reactive({\n  ...toRefs(props),\n  $el: formItemRef,\n  size: _size,\n  validateState,\n  labelId,\n  inputIds,\n  isGroup,\n  hasLabel,\n  addInputId,\n  removeInputId,\n  resetField,\n  clearValidate,\n  validate,\n})\n\nprovide(formItemContextKey, context)\n\nonMounted(() => {\n  if (props.prop) {\n    formContext?.addField(context)\n    initialValue = clone(fieldValue.value)\n  }\n})\n\nonBeforeUnmount(() => {\n  formContext?.removeField(context)\n})\n\ndefineExpose({\n  /**\n   * @description Form item size.\n   */\n  size: _size,\n  /**\n   * @description Validation message.\n   */\n  validateMessage,\n  /**\n   * @description Validation state.\n   */\n  validateState,\n  /**\n   * @description Validate form item.\n   */\n  validate,\n  /**\n   * @description Remove validation status of the field.\n   */\n  clearValidate,\n  /**\n   * @description Reset current field and remove validation result.\n   */\n  resetField,\n})\n</script>\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}