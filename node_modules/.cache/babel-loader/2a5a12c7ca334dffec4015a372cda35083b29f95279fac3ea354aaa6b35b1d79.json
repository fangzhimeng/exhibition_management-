{"ast":null,"code":"'use strict';\n\nrequire(\"core-js/modules/es.array.push.js\");\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nvar vue = require('vue');\nrequire('../../../../utils/index.js');\nvar constants = require('../constants.js');\nvar _private = require('../private.js');\nvar utils = require('./utils.js');\nvar shared = require('@vue/shared');\nfunction useColumns(props, columns, fixed) {\n  const visibleColumns = vue.computed(() => {\n    return vue.unref(columns).filter(column => !column.hidden);\n  });\n  const fixedColumnsOnLeft = vue.computed(() => vue.unref(visibleColumns).filter(column => column.fixed === \"left\" || column.fixed === true));\n  const fixedColumnsOnRight = vue.computed(() => vue.unref(visibleColumns).filter(column => column.fixed === \"right\"));\n  const normalColumns = vue.computed(() => vue.unref(visibleColumns).filter(column => !column.fixed));\n  const mainColumns = vue.computed(() => {\n    const ret = [];\n    vue.unref(fixedColumnsOnLeft).forEach(column => {\n      ret.push({\n        ...column,\n        placeholderSign: _private.placeholderSign\n      });\n    });\n    vue.unref(normalColumns).forEach(column => {\n      ret.push(column);\n    });\n    vue.unref(fixedColumnsOnRight).forEach(column => {\n      ret.push({\n        ...column,\n        placeholderSign: _private.placeholderSign\n      });\n    });\n    return ret;\n  });\n  const hasFixedColumns = vue.computed(() => {\n    return vue.unref(fixedColumnsOnLeft).length || vue.unref(fixedColumnsOnRight).length;\n  });\n  const columnsStyles = vue.computed(() => {\n    const _columns = vue.unref(columns);\n    return _columns.reduce((style, column) => {\n      style[column.key] = utils.calcColumnStyle(column, vue.unref(fixed), props.fixed);\n      return style;\n    }, {});\n  });\n  const columnsTotalWidth = vue.computed(() => {\n    return vue.unref(visibleColumns).reduce((width, column) => width + column.width, 0);\n  });\n  const getColumn = key => {\n    return vue.unref(columns).find(column => column.key === key);\n  };\n  const getColumnStyle = key => {\n    return vue.unref(columnsStyles)[key];\n  };\n  const updateColumnWidth = (column, width) => {\n    column.width = width;\n  };\n  function onColumnSorted(e) {\n    var _a;\n    const {\n      key\n    } = e.currentTarget.dataset;\n    if (!key) return;\n    const {\n      sortState,\n      sortBy\n    } = props;\n    let order = constants.SortOrder.ASC;\n    if (shared.isObject(sortState)) {\n      order = constants.oppositeOrderMap[sortState[key]];\n    } else {\n      order = constants.oppositeOrderMap[sortBy.order];\n    }\n    (_a = props.onColumnSort) == null ? void 0 : _a.call(props, {\n      column: getColumn(key),\n      key,\n      order\n    });\n  }\n  return {\n    columns,\n    columnsStyles,\n    columnsTotalWidth,\n    fixedColumnsOnLeft,\n    fixedColumnsOnRight,\n    hasFixedColumns,\n    mainColumns,\n    normalColumns,\n    visibleColumns,\n    getColumn,\n    getColumnStyle,\n    updateColumnWidth,\n    onColumnSorted\n  };\n}\nexports.useColumns = useColumns;","map":{"version":3,"names":["useColumns","props","columns","fixed","visibleColumns","vue","computed","unref","filter","column","hidden","fixedColumnsOnLeft","fixedColumnsOnRight","normalColumns","mainColumns","ret","forEach","push","placeholderSign","_private","hasFixedColumns","length","columnsStyles","_columns","reduce","style","key","utils","calcColumnStyle","columnsTotalWidth","width","getColumn","find","getColumnStyle","updateColumnWidth","onColumnSorted","e","_a","currentTarget","dataset","sortState","sortBy","order","constants","SortOrder","ASC","shared","isObject","oppositeOrderMap","onColumnSort","call"],"sources":["../../../../../../../packages/components/table-v2/src/composables/use-columns.ts"],"sourcesContent":["// @ts-nocheck\nimport { computed, unref } from 'vue'\nimport { isObject } from '@element-plus/utils'\nimport { SortOrder, oppositeOrderMap } from '../constants'\nimport { placeholderSign } from '../private'\nimport { calcColumnStyle } from './utils'\n\nimport type { CSSProperties, Ref } from 'vue'\nimport type { TableV2Props } from '../table'\nimport type { AnyColumns, Column, KeyType } from '../types'\n\nfunction useColumns(\n  props: TableV2Props,\n  columns: Ref<AnyColumns>,\n  fixed: Ref<boolean>\n) {\n  const visibleColumns = computed(() => {\n    return unref(columns).filter((column) => !column.hidden)\n  })\n\n  const fixedColumnsOnLeft = computed(() =>\n    unref(visibleColumns).filter(\n      (column) => column.fixed === 'left' || column.fixed === true\n    )\n  )\n\n  const fixedColumnsOnRight = computed(() =>\n    unref(visibleColumns).filter((column) => column.fixed === 'right')\n  )\n\n  const normalColumns = computed(() =>\n    unref(visibleColumns).filter((column) => !column.fixed)\n  )\n\n  const mainColumns = computed(() => {\n    const ret: AnyColumns = []\n\n    unref(fixedColumnsOnLeft).forEach((column) => {\n      ret.push({\n        ...column,\n        placeholderSign,\n      })\n    })\n\n    unref(normalColumns).forEach((column) => {\n      ret.push(column)\n    })\n\n    unref(fixedColumnsOnRight).forEach((column) => {\n      ret.push({\n        ...column,\n        placeholderSign,\n      })\n    })\n\n    return ret\n  })\n\n  const hasFixedColumns = computed(() => {\n    return unref(fixedColumnsOnLeft).length || unref(fixedColumnsOnRight).length\n  })\n\n  const columnsStyles = computed(() => {\n    const _columns = unref(columns)\n\n    return _columns.reduce<Record<Column<any>['key'], CSSProperties>>(\n      (style, column) => {\n        style[column.key] = calcColumnStyle(column, unref(fixed), props.fixed)\n        return style\n      },\n      {}\n    )\n  })\n\n  const columnsTotalWidth = computed(() => {\n    return unref(visibleColumns).reduce(\n      (width, column) => width + column.width,\n      0\n    )\n  })\n\n  const getColumn = (key: KeyType) => {\n    return unref(columns).find((column) => column.key === key)\n  }\n\n  const getColumnStyle = (key: KeyType) => {\n    return unref(columnsStyles)[key]\n  }\n\n  const updateColumnWidth = (column: Column<any>, width: number) => {\n    column.width = width\n  }\n\n  function onColumnSorted(e: MouseEvent) {\n    const { key } = (e.currentTarget as HTMLElement).dataset\n    if (!key) return\n    const { sortState, sortBy } = props\n\n    let order = SortOrder.ASC\n\n    if (isObject(sortState)) {\n      order = oppositeOrderMap[sortState[key]]\n    } else {\n      order = oppositeOrderMap[sortBy.order]\n    }\n\n    props.onColumnSort?.({ column: getColumn(key)!, key, order })\n  }\n\n  return {\n    columns,\n    columnsStyles,\n    columnsTotalWidth,\n    fixedColumnsOnLeft,\n    fixedColumnsOnRight,\n    hasFixedColumns,\n    mainColumns,\n    normalColumns,\n    visibleColumns,\n\n    getColumn,\n    getColumnStyle,\n    updateColumnWidth,\n    onColumnSorted,\n  }\n}\n\nexport { useColumns }\nexport type UseColumnsReturn = ReturnType<typeof useColumns>\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}