{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nvar vue = require('vue');\nvar collection = require('./collection2.js');\nvar collectionItem = require('./collection-item.js');\nconst COLLECTION_ITEM_SIGN = `data-el-collection-item`;\nconst createCollectionWithScope = name => {\n  const COLLECTION_NAME = `El${name}Collection`;\n  const COLLECTION_ITEM_NAME = `${COLLECTION_NAME}Item`;\n  const COLLECTION_INJECTION_KEY = Symbol(COLLECTION_NAME);\n  const COLLECTION_ITEM_INJECTION_KEY = Symbol(COLLECTION_ITEM_NAME);\n  const ElCollection = {\n    ...collection[\"default\"],\n    name: COLLECTION_NAME,\n    setup() {\n      const collectionRef = vue.ref(null);\n      const itemMap = /* @__PURE__ */new Map();\n      const getItems = () => {\n        const collectionEl = vue.unref(collectionRef);\n        if (!collectionEl) return [];\n        const orderedNodes = Array.from(collectionEl.querySelectorAll(`[${COLLECTION_ITEM_SIGN}]`));\n        const items = [...itemMap.values()];\n        return items.sort((a, b) => orderedNodes.indexOf(a.ref) - orderedNodes.indexOf(b.ref));\n      };\n      vue.provide(COLLECTION_INJECTION_KEY, {\n        itemMap,\n        getItems,\n        collectionRef\n      });\n    }\n  };\n  const ElCollectionItem = {\n    ...collectionItem[\"default\"],\n    name: COLLECTION_ITEM_NAME,\n    setup(_, {\n      attrs\n    }) {\n      const collectionItemRef = vue.ref(null);\n      const collectionInjection = vue.inject(COLLECTION_INJECTION_KEY, void 0);\n      vue.provide(COLLECTION_ITEM_INJECTION_KEY, {\n        collectionItemRef\n      });\n      vue.onMounted(() => {\n        const collectionItemEl = vue.unref(collectionItemRef);\n        if (collectionItemEl) {\n          collectionInjection.itemMap.set(collectionItemEl, {\n            ref: collectionItemEl,\n            ...attrs\n          });\n        }\n      });\n      vue.onBeforeUnmount(() => {\n        const collectionItemEl = vue.unref(collectionItemRef);\n        collectionInjection.itemMap.delete(collectionItemEl);\n      });\n    }\n  };\n  return {\n    COLLECTION_INJECTION_KEY,\n    COLLECTION_ITEM_INJECTION_KEY,\n    ElCollection,\n    ElCollectionItem\n  };\n};\nexports.COLLECTION_ITEM_SIGN = COLLECTION_ITEM_SIGN;\nexports.createCollectionWithScope = createCollectionWithScope;","map":{"version":3,"names":["COLLECTION_ITEM_SIGN","createCollectionWithScope","name","COLLECTION_NAME","COLLECTION_ITEM_NAME","COLLECTION_INJECTION_KEY","Symbol","COLLECTION_ITEM_INJECTION_KEY","ElCollection","collection","setup","collectionRef","vue","ref","itemMap","Map","getItems","collectionEl","unref","orderedNodes","Array","from","querySelectorAll","items","values","sort","a","b","indexOf","provide","ElCollectionItem","collectionItem","_","attrs","collectionItemRef","collectionInjection","inject","onMounted","collectionItemEl","set","onBeforeUnmount","delete"],"sources":["../../../../../../packages/components/collection/src/collection.ts"],"sourcesContent":["import { inject, onBeforeUnmount, onMounted, provide, ref, unref } from 'vue'\nimport Collection from './collection.vue'\nimport CollectionItem from './collection-item.vue'\n\nimport type { InjectionKey } from 'vue'\nimport type { SetupContext } from '@vue/runtime-core'\nimport type {\n  ElCollectionInjectionContext,\n  ElCollectionItemInjectionContext,\n} from './tokens'\n\nexport const COLLECTION_ITEM_SIGN = `data-el-collection-item`\n\n// Make sure the first letter of name is capitalized\nexport const createCollectionWithScope = (name: string) => {\n  const COLLECTION_NAME = `El${name}Collection`\n  const COLLECTION_ITEM_NAME = `${COLLECTION_NAME}Item`\n  const COLLECTION_INJECTION_KEY: InjectionKey<ElCollectionInjectionContext> =\n    Symbol(COLLECTION_NAME)\n  const COLLECTION_ITEM_INJECTION_KEY: InjectionKey<ElCollectionItemInjectionContext> =\n    Symbol(COLLECTION_ITEM_NAME)\n\n  const ElCollection = {\n    ...Collection,\n    name: COLLECTION_NAME,\n    setup() {\n      const collectionRef = ref<HTMLElement | null>(null)\n      const itemMap: ElCollectionInjectionContext['itemMap'] = new Map()\n      const getItems = () => {\n        const collectionEl = unref(collectionRef)\n\n        if (!collectionEl) return []\n        const orderedNodes = Array.from(\n          collectionEl.querySelectorAll(`[${COLLECTION_ITEM_SIGN}]`)\n        )\n\n        const items = [...itemMap.values()]\n\n        return items.sort(\n          (a, b) => orderedNodes.indexOf(a.ref!) - orderedNodes.indexOf(b.ref!)\n        )\n      }\n\n      provide(COLLECTION_INJECTION_KEY, {\n        itemMap,\n        getItems,\n        collectionRef,\n      })\n    },\n  }\n\n  const ElCollectionItem = {\n    ...CollectionItem,\n    name: COLLECTION_ITEM_NAME,\n    setup(_: unknown, { attrs }: SetupContext) {\n      const collectionItemRef = ref<HTMLElement | null>(null)\n      const collectionInjection = inject(COLLECTION_INJECTION_KEY, undefined)!\n\n      provide(COLLECTION_ITEM_INJECTION_KEY, {\n        collectionItemRef,\n      })\n\n      onMounted(() => {\n        const collectionItemEl = unref(collectionItemRef)\n        if (collectionItemEl) {\n          collectionInjection.itemMap.set(collectionItemEl, {\n            ref: collectionItemEl,\n            ...attrs,\n          })\n        }\n      })\n\n      onBeforeUnmount(() => {\n        const collectionItemEl = unref(collectionItemRef)!\n        collectionInjection.itemMap.delete(collectionItemEl)\n      })\n    },\n  }\n\n  return {\n    COLLECTION_INJECTION_KEY,\n    COLLECTION_ITEM_INJECTION_KEY,\n    ElCollection,\n    ElCollectionItem,\n  }\n}\n"],"mappings":";;;;;;;;AAGY,MAACA,oBAAoB,GAAI,yBAAuB;AAChD,MAACC,yBAAyB,GAAIC,IAAI,IAAK;EACjD,MAAMC,eAAe,GAAI,KAAID,IAAK,YAAW;EAC7C,MAAME,oBAAoB,GAAI,GAAED,eAAgB,MAAK;EACrD,MAAME,wBAAwB,GAAGC,MAAM,CAACH,eAAe,CAAC;EACxD,MAAMI,6BAA6B,GAAGD,MAAM,CAACF,oBAAoB,CAAC;EAClE,MAAMI,YAAY,GAAG;IACnB,GAAGC,UAAA,WAAU;IACbP,IAAI,EAAEC,eAAe;IACrBO,KAAKA,CAAA,EAAG;MACN,MAAMC,aAAa,GAAGC,GAAA,CAAAC,GAAG,CAAC,IAAI,CAAC;MAC/B,MAAMC,OAAO,kBAAmB,IAAIC,GAAG,EAAE;MACzC,MAAMC,QAAQ,GAAGA,CAAA,KAAM;QACrB,MAAMC,YAAY,GAAGL,GAAA,CAAAM,KAAK,CAACP,aAAa,CAAC;QACzC,IAAI,CAACM,YAAY,EACf,OAAO,EAAE;QACX,MAAME,YAAY,GAAGC,KAAK,CAACC,IAAI,CAACJ,YAAY,CAACK,gBAAgB,CAAE,IAAGtB,oBAAqB,GAAE,CAAC,CAAC;QAC3F,MAAMuB,KAAK,GAAG,CAAC,GAAGT,OAAO,CAACU,MAAM,EAAE,CAAC;QACnC,OAAOD,KAAK,CAACE,IAAI,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAKR,YAAY,CAACS,OAAO,CAACF,CAAC,CAACb,GAAG,CAAC,GAAGM,YAAY,CAACS,OAAO,CAACD,CAAC,CAACd,GAAG,CAAC,CAAC;MAC9F,CAAO;MACDD,GAAA,CAAAiB,OAAO,CAACxB,wBAAwB,EAAE;QAChCS,OAAO;QACPE,QAAQ;QACRL;MACR,CAAO,CAAC;IACR;EACA,CAAG;EACD,MAAMmB,gBAAgB,GAAG;IACvB,GAAGC,cAAA,WAAc;IACjB7B,IAAI,EAAEE,oBAAoB;IAC1BM,KAAKA,CAACsB,CAAC,EAAE;MAAEC;IAAK,CAAE,EAAE;MAClB,MAAMC,iBAAiB,GAAGtB,GAAA,CAAAC,GAAG,CAAC,IAAI,CAAC;MACnC,MAAMsB,mBAAmB,GAAGvB,GAAA,CAAAwB,MAAM,CAAC/B,wBAAwB,EAAE,KAAK,CAAC,CAAC;MACpEO,GAAA,CAAAiB,OAAO,CAACtB,6BAA6B,EAAE;QACrC2B;MACR,CAAO,CAAC;MACFtB,GAAA,CAAAyB,SAAS,CAAC,MAAM;QACd,MAAMC,gBAAgB,GAAG1B,GAAA,CAAAM,KAAK,CAACgB,iBAAiB,CAAC;QACjD,IAAII,gBAAgB,EAAE;UACpBH,mBAAmB,CAACrB,OAAO,CAACyB,GAAG,CAACD,gBAAgB,EAAE;YAChDzB,GAAG,EAAEyB,gBAAgB;YACrB,GAAGL;UACf,CAAW,CAAC;QACZ;MACA,CAAO,CAAC;MACFrB,GAAA,CAAA4B,eAAe,CAAC,MAAM;QACpB,MAAMF,gBAAgB,GAAG1B,GAAA,CAAAM,KAAK,CAACgB,iBAAiB,CAAC;QACjDC,mBAAmB,CAACrB,OAAO,CAAC2B,MAAM,CAACH,gBAAgB,CAAC;MAC5D,CAAO,CAAC;IACR;EACA,CAAG;EACD,OAAO;IACLjC,wBAAwB;IACxBE,6BAA6B;IAC7BC,YAAY;IACZsB;EACJ,CAAG;AACH"},"metadata":{},"sourceType":"script","externalDependencies":[]}